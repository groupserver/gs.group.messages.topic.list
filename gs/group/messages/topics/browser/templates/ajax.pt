<div id="gs-group-messages-topics-ajax-response"
  tal:define="munge_date python:modules['Products.XWFCore.XWFUtils'].munge_date;">
  <ul class="searchResults" tal:condition="view/viewTopics">
    <tal:block repeat="topic view/topics">
      <li id="topic" class="gs-search-result"
        tal:attributes="id string:gs-group-messages-topics-ajax-response-${topic/topic_id}">
        <a class="topic" href="#"
          tal:attributes="href string:/r/topic/${topic/last_post_id}">
          <span tal:condition="topic/sticky | nothing"
            title="Sticky"
            class="sticky gs-search-sticky ui-icon ui-icon-pin-s">&#160;</span>
          <span class="name"
              tal:content="topic/subject">TopicName</span></a><!--topic-->
        <span class="files" tal:condition="topic/files">
          <tal:block tal:repeat="file python:topic['files'][-7:]">
            <a href="#" title="foo"
              tal:attributes="title file/name;
                href file/url;
                class string:fileIcon ${file/icon}">&#160;</a>
          </tal:block>
        </span>
        <div class="tags" tal:condition="topic/keywords">
          <ul class="inline-list">
            <tal:block tal:repeat="keyword topic/keywords">
              <li>
                <a href="#" class="keyword gs-search-keyword"
                  tal:content="keyword/word">Keyword</a>
              </li>
            </tal:block>
          </ul>
        </div><!--tags-->
        <div class="metadata"
          tal:define="multiplePosts python:topic['num_posts']&gt;1">
          <span class="postCount">
            <span class="cardinal" tal:content="topic/num_posts"/>
            post<tal:block condition="multiplePosts">s</tal:block> 
          </span>
          &#8212;
          <tal:block condition="multiplePosts">latest post</tal:block>
          by
          <a class="name" href="#" 
            tal:omit-tag="not:topic/last_author/exists"
            tal:attributes="href topic/last_author/url"
            tal:content="topic/last_author/name">Me!</a>
          at
          <span class="date"
            tal:define="ctx view/context; d topic/last_post_date" 
            tal:content="python:munge_date(ctx, d)"/>
        </div><!--metadata-->
      </li>
    </tal:block>
  </ul><!--searchResults-->
  <p tal:condition="not:view/viewTopics">
    Only members can view the topics.
  </p>
</div><!--gs-group-messages-topics-ajax-response-->
